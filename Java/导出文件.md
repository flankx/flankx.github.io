# 导出文件

## 一、java导出数据到`EXCEL`

+ 1 引入依赖

````xml
<dependency>
    <groupId>com.alibaba</groupId>
    <artifactId>easyexcel</artifactId>
    <version>${version}</version>
</dependency>
````

+ 2 写`EXCEL`

````java
    response.setContentType("application/vnd.ms-excel");
    response.setCharacterEncoding(StandardCharsets.UTF_8.name());
    fileName = URLEncoder.encode(fileName, StandardCharsets.UTF_8.name());
    response.setHeader("Content-disposition", "attachment;filename=" + fileName + ".xlsx");
    EasyExcel.write(response.getOutputStream()).head(head).sheet(sheetName).doWrite(dataList);
````

## 二、java导出数据到`WORD`

+ 1 引入依赖

````xml
<!-- https://mvnrepository.com/artifact/org.apache.poi/poi -->
<dependency>
    <groupId>org.apache.poi</groupId>
    <artifactId>poi</artifactId>
    <version>${version}</version>
</dependency>
<!-- https://mvnrepository.com/artifact/org.apache.poi/poi-ooxml -->
<dependency>
    <groupId>org.apache.poi</groupId>
    <artifactId>poi-ooxml</artifactId>
    <version>${version}</version>
</dependency>
<!-- poi-tl基于poi的word模板引擎 -->
<dependency>
    <groupId>com.deepoove</groupId>
    <artifactId>poi-tl</artifactId>
    <version>${version}</version>
</dependency>
</dependency>
````

+ 2 写`WORD`

````java
    response.setContentType("application/msword");
    response.setCharacterEncoding(StandardCharsets.UTF_8.name());
    fileName = URLEncoder.encode(fileName, StandardCharsets.UTF_8.name());
    response.setHeader("Content-disposition", "attachment;filename=" + fileName + ".docx");

    XWPFDocument doc = new XWPFDocument();
    // 创建一个表格，并指定宽度
    XWPFTable table = doc.createTable(headSize + dataSize, head.size());
    // 表格宽度
    TableTools.widthTable(table, MiniTableRenderData.WIDTH_A4_FULL, 4);
    // 设置表格居中
    TableStyle style = new TableStyle();
    style.setAlign(STJc.CENTER);
    TableTools.styleTable(table, style);

    List<XWPFTableCell> row0 = table.getRow(0).getTableCells();
    row0.get(0).setText("第一列");
    row0.get(1).setText("第二列");
    row0.get(2).setText("第三列");
    // 写入流
    try (ServletOutputStream outputStream = response.getOutputStream()) {
        doc.write(outputStream);
    }
````

## 三、java导出数据到`PDF`

+ 1 引入依赖

````xml
<dependency>
    <groupId>com.itextpdf</groupId>
    <artifactId>itextpdf</artifactId>
    <version>${version}</version>
</dependency>
<dependency>
    <groupId>com.itextpdf</groupId>
    <artifactId>itext-asian</artifactId>
    <version>${version}</version>
</dependency>
````

+ 2 写`PDF`

````java
    response.setContentType("application/pdf");
    response.setCharacterEncoding(StandardCharsets.UTF_8.name());
    fileName = URLEncoder.encode(fileName, StandardCharsets.UTF_8.name());
    response.setHeader("Content-disposition", "attachment;filename=" + fileName + ".pdf");

    // 新建document对象
    Document document = new Document(PageSize.A4);
    // 创建 PdfWriter 对象
    PdfWriter.getInstance(document, response.getOutputStream());
    // 打开文档
    document.open();
    // pdf文档中中文字体的设置，注意一定要添加iTextAsian.jar包
    BaseFont bfChinese = BaseFont.createFont("STSong-Light", "UniGB-UCS2-H", BaseFont.NOT_EMBEDDED);
    // 加入document：
    Font fontChinese = new Font(bfChinese, 12, Font.BOLD);
    // 创建表格对象（包含行列矩阵的表格）;
    PdfPTable table = new PdfPTable(size);
    table.setPaddingTop(5);
    table.setSpacingAfter(5);
    // 表格总宽度
    table.setTotalWidth(400);
    // 锁定宽度
    table.setLockedWidth(true);
    // 列
    PdfPCell cell1 = new PdfPCell(new Paragraph("第一列", fontChinese));
    table.addCell(cell1);
    PdfPCell cell2 = new PdfPCell(new Paragraph("第二列", fontChinese));
    table.addCell(cell2);
    PdfPCell cell3 = new PdfPCell(new Paragraph("第三列", fontChinese));
    table.addCell(cell3);
    // 写入流
    document.add(table);
    document.close();
````
